{"version":3,"sources":["controllers/articles.server.controller.ts"],"names":[],"mappings":"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","file":"controllers/articles.server.controller.js","sourcesContent":["'use strict';\n\n/**\n * Module dependencies.\n */\nvar errorHandler = require('./errors.server.controller'),\n\tArticle = require('../models/article.server.model.js'),\n\t_ = require('lodash');\n\n/**\n * Create a article\n */\nexports.create = function(req, res) {\n\tvar article = new Article(req.body);\n\tarticle.user = req.user;\n\n\tarticle.saveAll(function(err) {\n\t\tif (err) {\n\t\t\treturn res.status(400).send({\n\t\t\t\tmessage: errorHandler.getErrorMessage(err)\n\t\t\t});\n\t\t} else {\n\t\t\tres.json(article);\n\t\t}\n\t});\n};\n\n/**\n * Show the current article\n */\nexports.read = function(req, res) {\n\tres.json(req.article);\n};\n\n/**\n * Update a article\n */\nexports.update = function(req, res) {\n\tvar article = req.article;\n\n\tarticle = _.extend(article, req.body);\n\n\tarticle.saveAll(function(err) {\n\t\tif (err) {\n\t\t\treturn res.status(400).send({\n\t\t\t\tmessage: errorHandler.getErrorMessage(err)\n\t\t\t});\n\t\t} else {\n\t\t\tres.json(article);\n\t\t}\n\t});\n};\n\n/**\n * Delete an article\n */\nexports.delete = function(req, res) {\n\tvar article = req.article;\n\n\tarticle.delete(function(err) {\n\t\tif (err) {\n\t\t\treturn res.status(400).send({\n\t\t\t\tmessage: errorHandler.getErrorMessage(err)\n\t\t\t});\n\t\t} else {\n\t\t\tres.json(article);\n\t\t}\n\t});\n};\n\n/**\n * List of Articles\n */\nexports.list = function(req, res) {\n\tArticle.get().sort('-created').populate('user', 'displayName').exec(function(err, articles) {\n\t\tif (err) {\n\t\t\treturn res.status(400).send({\n\t\t\t\tmessage: errorHandler.getErrorMessage(err)\n\t\t\t});\n\t\t} else {\n\t\t\tres.json(articles);\n\t\t}\n\t});\n};\n\n/**\n * Article middleware\n */\nexports.articleByID = function(req, res, next, id) {\n\tArticle.get(id).populate('user', 'displayName').exec(function(err, article) {\n\t\tif (err) return next(err);\n\t\tif (!article) return next(new Error('Failed to load article ' + id));\n\t\treq.article = article;\n\t\tnext();\n\t});\n};\n\n/**\n * Article authorization middleware\n */\nexports.hasAuthorization = function(req, res, next) {\n\tif (req.article.user.id !== req.user.id) {\n\t\treturn res.status(403).send({\n\t\t\tmessage: 'User is not authorized'\n\t\t});\n\t}\n\tnext();\n};\n"],"sourceRoot":"/source/"}